import{cn as H}from"./optional/blueprint-editor-BF9JwLNn.js";import{c as W}from"./_virtual_cors-proxy-url-DfPPJwK5.js";import"./optional/vendor-codemirror-CjDT2NJG.js";import"./optional/vendor-lezer-BVuE63-5.js";import"./optional/lang-php-DAdSG8P3.js";import"./optional/lang-html-B08Fw0dr.js";import"./optional/lang-css-DVB8fG3-.js";import"./optional/lang-javascript-rj9Dnv5V.js";const V="http://json-schema.org/schema",N="#/definitions/BlueprintV1Declaration",A={BlueprintV1Declaration:{type:"object",properties:{landingPage:{type:"string",description:"The URL to navigate to after the blueprint has been run."},description:{type:"string",description:"Optional description. It doesn't do anything but is exposed as a courtesy to developers who may want to document which blueprint file does what.",deprecated:"Use meta.description instead."},meta:{type:"object",properties:{title:{type:"string",description:"A clear and concise name for your Blueprint."},description:{type:"string",description:"A brief explanation of what your Blueprint offers."},author:{type:"string",description:"A GitHub username of the author of this Blueprint."},categories:{type:"array",items:{type:"string"},description:"Relevant categories to help users find your Blueprint in the future Blueprints section on WordPress.org."}},required:["title","author"],additionalProperties:!1,description:"Optional metadata. Used by the Blueprints gallery at https://github.com/WordPress/blueprints"},preferredVersions:{type:"object",properties:{php:{anyOf:[{$ref:"#/definitions/SupportedPHPVersion"},{type:"string",const:"latest"}],description:"The preferred PHP version to use. If not specified, the latest supported version will be used"},wp:{type:"string",description:"The preferred WordPress version to use. If not specified, the latest supported version will be used"}},required:["php","wp"],additionalProperties:!1,description:"The preferred PHP and WordPress versions to use."},features:{type:"object",properties:{intl:{type:"boolean"},networking:{type:"boolean",description:"Should boot with support for network request via wp_safe_remote_get?"}},additionalProperties:!1},extraLibraries:{type:"array",items:{$ref:"#/definitions/ExtraLibrary"},description:"Extra libraries to preload into the Playground instance."},constants:{$ref:"#/definitions/PHPConstants",description:"PHP Constants to define on every request"},plugins:{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/definitions/FileReference"}]},description:"WordPress plugins to install and activate"},siteOptions:{type:"object",additionalProperties:{type:"string"},properties:{blogname:{type:"string",description:"The site title"}},description:"WordPress site options to define"},login:{anyOf:[{type:"boolean"},{type:"object",properties:{username:{type:"string"},password:{type:"string"}},required:["username","password"],additionalProperties:!1}],description:"User to log in as. If true, logs the user in as admin/password."},phpExtensionBundles:{deprecated:"No longer used. Feel free to remove it from your Blueprint."},steps:{type:"array",items:{anyOf:[{$ref:"#/definitions/StepDefinition"},{type:"string"},{not:{}},{type:"boolean",const:!1},{type:"null"}]},description:"The steps to run after every other operation in this Blueprint was executed."},$schema:{type:"string"}},additionalProperties:!1,description:"The Blueprint declaration, typically stored in a blueprint.json file."},SupportedPHPVersion:{type:"string",enum:["8.4","8.3","8.2","8.1","8.0","7.4","7.3","7.2"]},ExtraLibrary:{type:"string",const:"wp-cli"},PHPConstants:{type:"object",additionalProperties:{type:["string","boolean","number"]}},FileReference:{anyOf:[{$ref:"#/definitions/VFSReference"},{$ref:"#/definitions/LiteralReference"},{$ref:"#/definitions/CoreThemeReference"},{$ref:"#/definitions/CorePluginReference"},{$ref:"#/definitions/UrlReference"},{$ref:"#/definitions/BundledReference"}]},VFSReference:{type:"object",properties:{resource:{type:"string",const:"vfs",description:"Identifies the file resource as Virtual File System (VFS)"},path:{type:"string",description:"The path to the file in the VFS"}},required:["resource","path"],additionalProperties:!1},LiteralReference:{type:"object",properties:{resource:{type:"string",const:"literal",description:"Identifies the file resource as a literal file"},name:{type:"string",description:"The name of the file"},contents:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"The contents of the file"}},required:["resource","name","contents"],additionalProperties:!1},CoreThemeReference:{type:"object",properties:{resource:{type:"string",const:"wordpress.org/themes",description:"Identifies the file resource as a WordPress Core theme"},slug:{type:"string",description:"The slug of the WordPress Core theme"}},required:["resource","slug"],additionalProperties:!1},CorePluginReference:{type:"object",properties:{resource:{type:"string",const:"wordpress.org/plugins",description:"Identifies the file resource as a WordPress Core plugin"},slug:{type:"string",description:"The slug of the WordPress Core plugin"}},required:["resource","slug"],additionalProperties:!1},UrlReference:{type:"object",properties:{resource:{type:"string",const:"url",description:"Identifies the file resource as a URL"},url:{type:"string",description:"The URL of the file"},caption:{type:"string",description:"Optional caption for displaying a progress message"}},required:["resource","url"],additionalProperties:!1},BundledReference:{type:"object",properties:{resource:{type:"string",const:"bundled",description:"Identifies the file resource as a Blueprint file"},path:{type:"string",description:"The path to the file in the Blueprint"}},required:["resource","path"],additionalProperties:!1},StepDefinition:{type:"object",discriminator:{propertyName:"step"},required:["step"],oneOf:[{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"activatePlugin"},pluginPath:{type:"string",description:"Path to the plugin directory as absolute path (/wordpress/wp-content/plugins/plugin-name); or the plugin entry file relative to the plugins directory (plugin-name/plugin-name.php)."},pluginName:{type:"string",description:"Optional. Plugin name to display in the progress bar."}},required:["pluginPath","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"activateTheme"},themeFolderName:{type:"string",description:"The name of the theme folder inside wp-content/themes/"}},required:["step","themeFolderName"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"cp"},fromPath:{type:"string",description:"Source path"},toPath:{type:"string",description:"Target path"}},required:["fromPath","step","toPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"defineWpConfigConsts"},consts:{type:"object",additionalProperties:{},description:"The constants to define"},method:{type:"string",enum:["rewrite-wp-config","define-before-run"],description:`The method of defining the constants in wp-config.php. Possible values are:

- rewrite-wp-config: Default. Rewrites the wp-config.php file to                      explicitly call define() with the requested                      name and value. This method alters the file                      on the disk, but it doesn't conflict with                      existing define() calls in wp-config.php.

- define-before-run: Defines the constant before running the requested                      script. It doesn't alter any files on the disk, but                      constants defined this way may conflict with existing                      define() calls in wp-config.php.`},virtualize:{type:"boolean",deprecated:`This option is noop and will be removed in a future version.
This option is only kept in here to avoid breaking Blueprint schema validation
for existing apps using this option.`}},required:["consts","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"defineSiteUrl"},siteUrl:{type:"string",description:"The URL"}},required:["siteUrl","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"enableMultisite"},wpCliPath:{type:"string",description:"wp-cli.phar path"}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importWxr"},file:{$ref:"#/definitions/FileReference",description:"The file to import"},importer:{type:"string",enum:["data-liberation","default"],description:"The importer to use. Possible values:\n\n- `default`: The importer from https://github.com/humanmade/WordPress-Importer\n- `data-liberation`: The experimental Data Liberation WXR importer developed at                      https://github.com/WordPress/wordpress-playground/issues/1894\n\nThis option is deprecated. The syntax will not be removed, but once the Data Liberation importer matures, it will become the only supported importer and the `importer` option will be ignored.",deprecated:!0}},required:["file","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importThemeStarterContent",description:"The step identifier."},themeSlug:{type:"string",description:"The name of the theme to import content from."}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importWordPressFiles"},wordPressFilesZip:{$ref:"#/definitions/FileReference",description:"The zip file containing the top-level WordPress files and directories."},pathInZip:{type:"string",description:"The path inside the zip file where the WordPress files are."}},required:["step","wordPressFilesZip"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},ifAlreadyInstalled:{type:"string",enum:["overwrite","skip","error"],description:"What to do if the asset already exists."},step:{type:"string",const:"installPlugin",description:"The step identifier."},pluginData:{anyOf:[{$ref:"#/definitions/FileReference"},{$ref:"#/definitions/DirectoryReference"}],description:"The plugin files to install. It can be a plugin zip file, a single PHP file, or a directory containing all the plugin files at its root."},pluginZipFile:{$ref:"#/definitions/FileReference",deprecated:". Use 'pluginData' instead."},options:{$ref:"#/definitions/InstallPluginOptions",description:"Optional installation options."}},required:["pluginData","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},ifAlreadyInstalled:{type:"string",enum:["overwrite","skip","error"],description:"What to do if the asset already exists."},step:{type:"string",const:"installTheme",description:"The step identifier."},themeData:{anyOf:[{$ref:"#/definitions/FileReference"},{$ref:"#/definitions/DirectoryReference"}],description:"The theme files to install. It can be either a theme zip file, or a directory containing all the theme files at its root."},themeZipFile:{$ref:"#/definitions/FileReference",deprecated:". Use 'themeData' instead."},options:{$ref:"#/definitions/InstallThemeOptions",description:"Optional installation options."}},required:["step","themeData"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"login"},username:{type:"string",description:"The user to log in as. Defaults to 'admin'."},password:{type:"string",deprecated:`The password field is deprecated and will be removed in a future version.
Only the username field is required for user authentication.`}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"mkdir"},path:{type:"string",description:"The path of the directory you want to create"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"mv"},fromPath:{type:"string",description:"Source path"},toPath:{type:"string",description:"Target path"}},required:["fromPath","step","toPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"resetData"}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"request"},request:{$ref:"#/definitions/PHPRequest",description:"Request details (See /wordpress-playground/api/universal/interface/PHPRequest)"}},required:["request","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"rm"},path:{type:"string",description:"The path to remove"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"rmdir"},path:{type:"string",description:"The path to remove"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runPHP",description:"The step identifier."},code:{anyOf:[{type:"string"},{type:"object",properties:{filename:{type:"string",description:"This property is ignored during Blueprint v1 execution but exists so the same runPHP step structure can be used for Blueprints v1 and v2."},content:{type:"string"}},required:["filename","content"],additionalProperties:!1}],description:"The PHP code to run."}},required:["code","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runPHPWithOptions"},options:{$ref:"#/definitions/PHPRunOptions",description:"Run options (See /wordpress-playground/api/universal/interface/PHPRunOptions/))"}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runWpInstallationWizard"},options:{$ref:"#/definitions/WordPressInstallationOptions"}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runSql",description:"The step identifier."},sql:{$ref:"#/definitions/FileReference",description:"The SQL to run. Each non-empty line must contain a valid SQL query."}},required:["sql","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"setSiteOptions",description:'The name of the step. Must be "setSiteOptions".'},options:{type:"object",additionalProperties:{},description:"The options to set on the site."}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"unzip"},zipFile:{$ref:"#/definitions/FileReference",description:"The zip file to extract"},zipPath:{type:"string",description:"The path of the zip file to extract",deprecated:"Use zipFile instead."},extractToPath:{type:"string",description:"The path to extract the zip file to"}},required:["extractToPath","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"updateUserMeta"},meta:{type:"object",additionalProperties:{},description:'An object of user meta values to set, e.g. { "first_name": "John" }'},userId:{type:"number",description:"User ID"}},required:["meta","step","userId"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"writeFile"},path:{type:"string",description:"The path of the file to write to"},data:{anyOf:[{$ref:"#/definitions/FileReference"},{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"The data to write"}},required:["data","path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"writeFiles"},writeToPath:{type:"string",description:"The path of the file to write to"},filesTree:{$ref:"#/definitions/DirectoryReference",description:"The 'filesTree' defines the directory structure, supporting 'literal:directory' or 'git:directory' types. The 'name' represents the root directory, while 'files' is an object where keys are file paths, and values contain either file content as a string or nested objects for subdirectories."}},required:["filesTree","step","writeToPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"wp-cli",description:"The step identifier."},command:{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:"The WP CLI command to run."},wpCliPath:{type:"string",description:"wp-cli.phar path"}},required:["command","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"setSiteLanguage"},language:{type:"string",description:"The language to set, e.g. 'en_US'"}},required:["language","step"]}]},DirectoryReference:{anyOf:[{$ref:"#/definitions/GitDirectoryReference"},{$ref:"#/definitions/DirectoryLiteralReference"}]},GitDirectoryReference:{type:"object",properties:{resource:{type:"string",const:"git:directory",description:"Identifies the file resource as a git directory"},url:{type:"string",description:"The URL of the git repository"},ref:{type:"string",description:"The ref (branch, tag, or commit) of the git repository"},refType:{$ref:"#/definitions/GitDirectoryRefType",description:"Explicit hint about the ref type (branch, tag, commit, refname)"},path:{type:"string",description:"The path to the directory in the git repository. Defaults to the repo root."},".git":{type:"boolean",description:"When true, include a `.git` directory with Git metadata (experimental)."}},required:["resource","url","ref"],additionalProperties:!1},GitDirectoryRefType:{type:"string",enum:["branch","tag","commit","refname"]},DirectoryLiteralReference:{type:"object",additionalProperties:!1,properties:{resource:{type:"string",const:"literal:directory",description:"Identifies the file resource as a git directory"},files:{$ref:"#/definitions/FileTree"},name:{type:"string"}},required:["files","name","resource"]},FileTree:{type:"object",additionalProperties:{anyOf:[{$ref:"#/definitions/FileTree"},{type:["object","string"]}]},properties:{}},InstallPluginOptions:{type:"object",properties:{activate:{type:"boolean",description:"Whether to activate the plugin after installing it."},targetFolderName:{type:"string",description:"The name of the folder to install the plugin to. Defaults to guessing from pluginData"}},additionalProperties:!1},InstallThemeOptions:{type:"object",properties:{activate:{type:"boolean",description:"Whether to activate the theme after installing it."},importStarterContent:{type:"boolean",description:"Whether to import the theme's starter content after installing it."},targetFolderName:{type:"string",description:"The name of the folder to install the theme to. Defaults to guessing from themeData"}},additionalProperties:!1},PHPRequest:{type:"object",properties:{method:{$ref:"#/definitions/HTTPMethod",description:"Request method. Default: `GET`."},url:{type:"string",description:"Request path or absolute URL."},headers:{$ref:"#/definitions/PHPRequestHeaders",description:"Request headers."},body:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}},{type:"object",additionalProperties:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}},{type:"object",properties:{size:{type:"number"},type:{type:"string"},lastModified:{type:"number"},name:{type:"string"},webkitRelativePath:{type:"string"}},required:["lastModified","name","size","type","webkitRelativePath"],additionalProperties:!1}]}}],description:"Request body. If an object is given, the request will be encoded as multipart and sent with a `multipart/form-data` header."}},required:["url"],additionalProperties:!1},HTTPMethod:{type:"string",enum:["GET","POST","HEAD","OPTIONS","PATCH","PUT","DELETE"]},PHPRequestHeaders:{type:"object",additionalProperties:{type:"string"}},PHPRunOptions:{type:"object",properties:{relativeUri:{type:"string",description:"Request path following the domain:port part â€“ after any URL rewriting rules (e.g. apache .htaccess) have been applied."},scriptPath:{type:"string",description:"Path of the .php file to execute."},protocol:{type:"string",description:"Request protocol."},method:{$ref:"#/definitions/HTTPMethod",description:"Request method. Default: `GET`."},headers:{$ref:"#/definitions/PHPRequestHeaders",description:"Request headers."},body:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"Request body."},env:{type:"object",additionalProperties:{type:"string"},description:"Environment variables to set for this run."},$_SERVER:{type:"object",additionalProperties:{type:"string"},description:"$_SERVER entries to set for this run."},code:{type:"string",description:"The code snippet to eval instead of a php file."}},additionalProperties:!1},WordPressInstallationOptions:{type:"object",properties:{adminUsername:{type:"string"},adminPassword:{type:"string"}},additionalProperties:!1}},w={$schema:V,$ref:N,definitions:A},M=new URL("..",document.location.href),z=(r,i)=>{if(!r||typeof r!="object"||!("$ref"in r))return r;const e=r.$ref.substr(2).split("/");let n=i;for(const o of e){if(!(o in n))throw new Error(`Invalid reference: "${r.$ref}"`);n=n[o]}return{...r,...n}},L=Symbol("reader"),T=(r,i=null)=>{if(r[L])return r[L];i||(i=r);const e=new Proxy(r,{get:(n,o,p)=>{const s=Reflect.get(n,o,p);return s&&typeof s=="object"?T(z(s,i),i):s}});return r[L]=e,e},k=(r,{column:i,row:e})=>{const o=r.getValue().split(`
`),p=String(o[e]),s=p.indexOf(":"),c=[];if(s>-1&&i>s){const l=p.indexOf('"'),f=p.indexOf('"',1+l);c.push(p.substring(1+l,f))}let u=0;for(;p[u]===" "||p[u]==="	";)u++;let t=-1+e;for(;t>=0;){const l=o[t].indexOf('"'),f=o[t].indexOf('"',1+l);l>-1&&l<u&&(c.push(o[t].substring(1+l,f)),u=l),t--}return c},R=(r,i,{column:e,row:n},o=0)=>{const s=r.getValue().split(`
`);let c=-1+n;for(;c>=0;){if(s[c].indexOf("{")>-1){if(--o<0)return null;c--;continue}let t=0;for(;s[c][t]===" "||s[c][t]==="	";)t++;const l=s[c].indexOf('"'),f=s[c].indexOf('"',1+l),y=s[c].indexOf('"',1+f),d=s[c].indexOf('"',1+y);if(l>-1&&l===t){const b=s[c].substring(1+l,f);if(i===b)return s[c].substring(1+y,d)}c--}return null},$=(r,{column:i,row:e})=>{const o=r.getValue().split(`
`);let p=-1+e,s=0;for(;o[e][s]===" "||o[e][s]==="	";)s++;const c=[];for(;p>=0;){const u=o[p].indexOf("{");if(u>-1&&u<s)break;const t=o[p].indexOf('"'),l=o[p].indexOf('"',1+t);t>-1&&t===s&&c.push(o[p].substring(1+t,l)),p--}return c},J=async r=>T(w).definitions.StepDefinition.oneOf.filter(e=>e.properties.step.const===r).map(e=>e.properties).flat().pop(),Q=async(r,i)=>w.definitions.StepDefinition.oneOf.filter(e=>e.properties.step.const===r).map(e=>Object.keys(e.properties)).flat().filter(e=>e.substr(0,i.length)===i).filter(e=>!["step","progress"].includes(e)),Y=async(r,i,e)=>T(w).definitions.StepDefinition.oneOf.filter(o=>o.properties.step.const===r).map(o=>o.properties[e].anyOf).flat().filter(o=>!i||o.properties.resource.const===i).map(o=>o.properties).flat().pop(),D=async(r,i,e,n,o)=>!i&&!n?["resource"]:T(w).definitions.StepDefinition.oneOf.filter(s=>s.properties.step.const===r).map(s=>s.properties[e].anyOf).flat().filter(s=>!i||s.properties.resource.const===i).map(s=>n===null?Object.keys(s.properties):s.properties.resource.const).flat().filter(s=>!["resource"].includes(s)),G=async r=>T(w).definitions.StepDefinition.oneOf.map(e=>e.properties.step.const).filter(e=>e.substr(0,r.length)===r),Z=async r=>T(w).definitions.SupportedPHPVersion.enum.filter(e=>e.substr(0,r.length)===r),K=async r=>{const i=T(w);return Object.keys(i.definitions.Blueprint.properties).filter(e=>e[0]!=="$"&&e.substr(0,r.length)===r)},X=async r=>{const i=T(w);return Object.keys(i.definitions.Blueprint.properties.features.properties).filter(e=>e[0]!=="$"&&e.substr(0,r.length)===r)};let P=null;const ee=async(r,i,e,n,o)=>{const p=[],s=k(r,e),u=r.getValue().split(`
`),l=String(u[e.row]).indexOf(":"),{row:f,column:y}=e,d=!u[f][-1+y]||u[f][-1+y]===" "?'"':"",b=!u[f][y]||u[f][y]===" "?'"':"";if(s.length===3&&n.length>=3&&(s.join("<")==="slug<pluginZipFile<steps"||s.join("<")==="slug<pluginData<steps")){const a=new URLSearchParams;a.set("action","query_plugins"),a.set("request[page]","1"),a.set("request[per_page]","200"),a.set("request[locale]","en_US"),a.set("request[search]",n),a.set("request[wp_version]","6.4");const g=new URLSearchParams;g.set("url",`http://api.wordpress.org/plugins/info/1.2/?${a}`),P&&(clearTimeout(P),P=null),document.body.setAttribute("data-loading",!0),P=setTimeout(async()=>{try{const h=new URL(`https://playground.wordpress.net/plugin-proxy.php?${g}`);(await(await fetch(h)).json())?.plugins.forEach(j=>{const E=new DOMParser().parseFromString(j.name,"text/html").documentElement.textContent;o(null,[{name:j.slug,value:d+j.slug+b,score:1,meta:E}])})}finally{document.body.setAttribute("data-loading",!1)}},250)}if(s.length===3&&n.length>=3&&(s.join("<")==="slug<themeData<steps"||s.join("<")==="slug<themeZipFile<steps")){const a=new URLSearchParams;a.set("action","query_themes"),a.set("request[page]","1"),a.set("request[per_page]","200"),a.set("request[locale]","en_US"),a.set("request[search]",n),a.set("request[wp_version]","6.4");const g=new URLSearchParams;g.set("url",`http://api.wordpress.org/themes/info/1.2/?${a}`),P&&(clearTimeout(P),P=null),document.body.setAttribute("data-loading",!0),P=setTimeout(async()=>{try{const h=new URL(`https://playground.wordpress.net/plugin-proxy.php?${g}`);(await(await fetch(h)).json())?.themes.forEach(j=>{const E=new DOMParser().parseFromString(j.name,"text/html").documentElement.textContent;o(null,[{name:j.slug,value:d+j.slug+b,score:1,meta:E}])})}finally{document.body.setAttribute("data-loading",!1)}},250)}switch(s[0]){case"preferredVersions":{const a=await $(r,e);p.push(...["wp","php"].filter(g=>!a.includes(g)));break}case"wp":p.push("latest");break;case"php":p.push(...await Z(n));break;case"steps":{const a=await $(r,e),g=R(r,"step",e);if(g){const h=await Q(g,n);p.push(...h.filter(m=>!a.includes(m)))}else p.push("step")}break;case"step":p.push(...await G(n));break;case"features":p.push(...await X(n));break;case void 0:p.push(...await K(n));break;default:switch(s[-1+s.length]){case"steps":{const a=R(r,"step",e,1),g=R(r,"resource",e,1);if(s.length===2){if(l===-1){const h=await $(r,e),m=await D(a,g,s[-2+s.length],null);p.push(...m.filter(O=>!h.includes(O)))}}else s.length===3&&s[0]==="resource"&&p.push(...await D(a,g,s[-2+s.length],s[0]))}break}break}for(const a of p)o(null,[{name:a,value:d+a+b,score:1,meta:"Blueprint Schema"}])};let q;const C=r=>{console.error(r),q||(q=document.getElementById("error-output"));const i=`<head><style>body{ color: red; font-family: monospace; } pre{ white-space: pre-wrap; } p{ margin: 0.25rem; }</style></head><body>${r}</body>`;q.setAttribute("srcdoc",i)},F=r=>{q||(q=document.getElementById("error-output")),q.setAttribute("srcdoc","")},I=(r,i={})=>{const e=r.getSession().getValue(),n=JSON.stringify(i,null,2)+`
`;n!==e&&(r.getSession().setValue(n),n!==e&&r.getSession().setValue(n))};function v(r){const i=JSON.parse(r.getValue());return i.features&&i.features.networking===!1&&(i.features.networking=!0),i}let x=0;const S=async r=>{const i=++x,e=document.createElement("iframe");let n=document.getElementById("wp-playground");n.parentNode.insertBefore(e,n),n.remove(),n=e,e.id="wp-playground";try{document.body.setAttribute("data-starting",!0),F();const o=v(r);I(r,o);const p=JSON.stringify(o);window.location.hash=p;const s=JSON.parse(p);await H({iframe:n,remoteUrl:"remote.html",blueprint:s,corsProxy:W})}catch(o){i===x&&C(o)}finally{i===x&&document.body.setAttribute("data-starting",!1)}},te=r=>{const i=decodeURI(window.location.hash.substr(1));try{let e="";try{e=JSON.parse(atob(i))}catch{e=JSON.parse(i)}return e}catch(e){console.error(e)}};function B(){const r=document.querySelector("button#run"),i=document.querySelector("button#new-tab"),e=ace.edit("jsontext");e.setTheme("ace/theme/github_dark"),e.session.setMode("ace/mode/json");const n=ace.require("ace/ext/language_tools");n.setCompleters([]),n.addCompleter({triggerCharacters:['"'],getCompletions:ee}),e.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,useSoftTabs:!0,tabSize:2}),e.getSession().on("change",async t=>{if(t.action!=="insert")return;const f=e.getValue().split(`
`);if(t.start.row===t.end.row&&1<Math.abs(t.start.column-t.end.column)&&f[t.end.row][t.end.column]==='"'){e.moveCursorTo(t.end.row,t.end.column+1);return}if(f[t.end.row][t.end.column])return;const y=t.lines.join(`
`),d=k(e,t.end);if(!(y.length>1)){if(y===":"){const b=f[t.start.row].indexOf(":");if(b>-1&&b<t.start.column)return;if(d.length===1&&d[0]==="landingPage"&&(e.getSession().insert({row:t.end.row,column:t.end.column},' ""'),e.moveCursorTo(t.end.row,1+t.end.column)),d.length===1&&d[0]==="preferredVersions"&&(e.getSession().insert({row:t.end.row,column:t.end.column}," {}"),e.moveCursorTo(t.end.row,1+t.end.column)),d.length===2&&d[1]==="preferredVersions"&&(e.getSession().insert({row:t.end.row,column:t.end.column},' ""'),e.moveCursorTo(t.end.row,1+t.end.column),setTimeout(()=>e.execCommand("startAutocomplete"),0)),d.length===1&&(d[0]==="steps"||d[0]==="features")&&(e.getSession().insert({row:t.end.row,column:t.end.column}," {}"),e.moveCursorTo(t.end.row,1+t.end.column)),d.length===3&&d[2]==="steps"){const a=R(e,"step",t.end,1),g=R(e,"resource",t.end),m=(await Y(a,g,d[1]))[d[0]];m?.type==="string"?(e.getSession().insert({row:t.end.row,column:t.end.column},' ""'),e.moveCursorTo(t.end.row,2+t.end.column),e.execCommand("startAutocomplete")):m?.type==="object"&&(e.getSession().insert({row:t.end.row,column:t.end.column}," {}"),e.moveCursorTo(t.end.row,2+t.end.column))}if(d.length===2&&d[1]==="steps"){const a=await R(e,"step",t.end),h=(await J(a))[d[0]]??null,m=h.type??null,O=h.$ref;m==="string"?(e.getSession().insert({row:t.end.row,column:t.end.column},' ""'),e.moveCursorTo(t.end.row,2+t.end.column)):O==="#/definitions/FileReference"&&(e.getSession().insert({row:t.end.row,column:t.end.column}," {}"),e.moveCursorTo(t.end.row,2+t.end.column))}}else if(y==="["){e.getSession().insert({row:t.end.row,column:t.start.column+1},"]");return}else if(y==="{"){e.getSession().insert({row:t.end.row,column:t.start.column+1},"}");return}}}),r.addEventListener("click",()=>{try{F(),S(e)}catch(t){C(t)}});let o;i.addEventListener("click",()=>{S(e);const t=new URLSearchParams;t.set("mode","seamless");const l=new URL(`?${t}#${JSON.stringify(v(e))}`,M);o&&o.close(),o=window.open(l,"_blank")}),re().then(t=>{I(e,t),S(e)}),e.commands.addCommand({name:"Run Blueprint",bindKey:{win:"Ctrl-Enter|Ctrl-S",mac:"Command-Enter|Command-S"},exec:t=>S(t),readOnly:!1});const p=document.querySelector("button#save"),s=document.querySelector("button#open"),c=()=>{const t=`data:application/json;base64,${btoa(JSON.stringify(JSON.parse(e.getValue()),null,2))}`,l=document.createElement("a");l.setAttribute("href",t),l.setAttribute("download",`blueprint-${new Date().toISOString()}.json`),l.click()},u=()=>{const t=document.createElement("input");t.setAttribute("type","file"),t.addEventListener("change",l=>{[...t.files].forEach(f=>{const y=new FileReader;y.addEventListener("load",()=>{e.setValue(JSON.stringify(JSON.parse(y.result),null,2)),e.moveCursorTo(0,0),S(e)}),y.readAsText(f)})}),t.click()};p.addEventListener("click",c),s.addEventListener("click",u),e.commands.addCommand({name:"Run Blueprint",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:t=>S(t),readOnly:!1})}const U={landingPage:"/wp-admin/",preferredVersions:{php:"7.4",wp:"5.9"},steps:[{step:"login",username:"admin"}]};async function re(){if(window.location.hash)return te();const r=new URLSearchParams(window.location.search);if(r.has("blueprint-url"))try{const i=new URL(r.get("blueprint-url"));if(i.hostname==="github.com"){const n=i.pathname.replace(/^\/([^/]+)\/([^/]+)\/(?:blob|raw)\//,"/$1/$2/");n!==i.pathname&&(i.pathname=n,i.hostname="raw.githubusercontent.com")}return console.log("blueprintUrl.toString()",i.toString()),await(await fetch(i.toString())).json()}catch(i){return C(i),U}return U}document.readyState!=="loading"?B():document.addEventListener("DOMContentLoaded",B);
//# sourceMappingURL=builder-D1BOXKog.js.map
